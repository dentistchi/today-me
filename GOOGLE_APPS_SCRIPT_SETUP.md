# Google Apps Script ì„¤ì • ê°€ì´ë“œ

## ğŸ¯ ê°œìš”
ì´ ê°€ì´ë“œëŠ” Google Apps Scriptë¥¼ í†µí•´ ìì¡´ê° ì§„ë‹¨ ì‹œìŠ¤í…œì˜ ì´ë©”ì¼ ìë™í™”ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

1. **Google ê³„ì •** (Gmail)
2. **Google Sheets** ë¬¸ì„œ (ë°ì´í„° ì €ì¥ìš©)
3. **Google Apps Script** í”„ë¡œì íŠ¸

---

## ğŸš€ 1ë‹¨ê³„: Google Sheets ìƒì„±

### 1.1 ìƒˆ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë§Œë“¤ê¸°
1. https://sheets.google.com ì ‘ì†
2. **ë¹ˆ ë¬¸ì„œ** í´ë¦­
3. ì œëª©ì„ **"ìì¡´ê° ì§„ë‹¨ ë°ì´í„°"**ë¡œ ë³€ê²½

### 1.2 ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ID ë³µì‚¬
1. URL í™•ì¸: `https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/edit`
2. `{SPREADSHEET_ID}` ë¶€ë¶„ì„ ë³µì‚¬ (ì˜ˆ: `1AbC2DeF3GhI4JkL5MnO6PqR`)

---

## ğŸ› ï¸ 2ë‹¨ê³„: Google Apps Script í”„ë¡œì íŠ¸ ìƒì„±

### 2.1 Apps Script ì—´ê¸°
1. Google Sheetsì—ì„œ **í™•ì¥ í”„ë¡œê·¸ë¨** > **Apps Script** í´ë¦­
2. ë˜ëŠ” ì§ì ‘ https://script.google.com ì ‘ì†

### 2.2 ì½”ë“œ ë¶™ì—¬ë„£ê¸°
1. ê¸°ë³¸ `myFunction()` ì½”ë“œ ì‚­ì œ
2. `google_apps_script.js` íŒŒì¼ì˜ ì „ì²´ ë‚´ìš© ë³µì‚¬
3. Apps Script ì—ë””í„°ì— ë¶™ì—¬ë„£ê¸°
4. **íŒŒì¼** > **ì €ì¥** (Ctrl+S)

### 2.3 í”„ë¡œì íŠ¸ ì´ë¦„ ì„¤ì •
- ì™¼ìª½ ìƒë‹¨ **ì œëª© ì—†ëŠ” í”„ë¡œì íŠ¸** í´ë¦­
- **"ìì¡´ê° ì§„ë‹¨ ì´ë©”ì¼ ì‹œìŠ¤í…œ"**ìœ¼ë¡œ ë³€ê²½

---

## âš™ï¸ 3ë‹¨ê³„: Script Properties ì„¤ì •

### 3.1 ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ID ë“±ë¡
1. Apps Script ì—ë””í„°ì—ì„œ **í”„ë¡œì íŠ¸ ì„¤ì •** (ì™¼ìª½ í†±ë‹ˆë°”í€´ ì•„ì´ì½˜) í´ë¦­
2. **ìŠ¤í¬ë¦½íŠ¸ ì†ì„±** ì„¹ì…˜ìœ¼ë¡œ ì´ë™
3. **ìŠ¤í¬ë¦½íŠ¸ ì†ì„± ì¶”ê°€** í´ë¦­
4. ë‹¤ìŒ ì •ë³´ ì…ë ¥:
   ```
   ì†ì„±: SPREADSHEET_ID
   ê°’: {ìœ„ì—ì„œ ë³µì‚¬í•œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ID}
   ```
5. **ìŠ¤í¬ë¦½íŠ¸ ì†ì„± ì €ì¥** í´ë¦­

---

## ğŸŒ 4ë‹¨ê³„: ì›¹ ì•±ìœ¼ë¡œ ë°°í¬

### 4.1 ë°°í¬ ì„¤ì •
1. Apps Script ì—ë””í„° ì˜¤ë¥¸ìª½ ìƒë‹¨ **ë°°í¬** > **ìƒˆ ë°°í¬** í´ë¦­
2. **ìœ í˜• ì„ íƒ** (í†±ë‹ˆë°”í€´ ì•„ì´ì½˜) > **ì›¹ ì•±** ì„ íƒ
3. ì„¤ì • ì…ë ¥:
   ```
   ì„¤ëª…: ìì¡´ê° ì§„ë‹¨ ì‹œìŠ¤í…œ v1.0
   ì‹¤í–‰í•  ì‚¬ìš©ì: ë‚˜ (ë³¸ì¸ ì´ë©”ì¼)
   ì•¡ì„¸ìŠ¤ ê¶Œí•œ: ëª¨ë“  ì‚¬ìš©ì
   ```
4. **ë°°í¬** í´ë¦­

### 4.2 ê¶Œí•œ ìŠ¹ì¸
1. **ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¶€ì—¬** í´ë¦­
2. Google ê³„ì • ì„ íƒ
3. **ê³ ê¸‰** > **{í”„ë¡œì íŠ¸ ì´ë¦„}(ìœ¼)ë¡œ ì´ë™** í´ë¦­
4. **í—ˆìš©** í´ë¦­

### 4.3 ì›¹ ì•± URL ë³µì‚¬
- ë°°í¬ ì™„ë£Œ í›„ í‘œì‹œë˜ëŠ” **ì›¹ ì•± URL** ë³µì‚¬
- ì˜ˆì‹œ: `https://script.google.com/macros/s/AKfycby.../exec`

---

## ğŸ”— 5ë‹¨ê³„: HTML íŒŒì¼ì— URL ì—°ë™

### 5.1 index.html ìˆ˜ì •
1. `index.html` íŒŒì¼ ì—´ê¸°
2. ë‹¤ìŒ ë¶€ë¶„ ì°¾ê¸°:
   ```javascript
   const GAS_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL';
   ```
3. `YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL`ì„ ë³µì‚¬í•œ ì›¹ ì•± URLë¡œ êµì²´
   ```javascript
   const GAS_URL = 'https://script.google.com/macros/s/AKfycby.../exec';
   ```

---

## âœ… 6ë‹¨ê³„: í…ŒìŠ¤íŠ¸

### 6.1 ê¸°ë³¸ í…ŒìŠ¤íŠ¸
1. `index.html` íŒŒì¼ì„ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°
2. ìì¡´ê° ì§„ë‹¨ ì„¤ë¬¸ ì‘ì„± (í…ŒìŠ¤íŠ¸ìš© ì´ë©”ì¼ ì…ë ¥)
3. ì œì¶œ í›„ í™•ì¸:
   - âœ‰ï¸ **ì¦‰ì‹œ**: ì§„ë‹¨ ì™„ë£Œ ì´ë©”ì¼ ìˆ˜ì‹  í™•ì¸
   - ğŸ“Š **Google Sheets**: ë°ì´í„° ì €ì¥ í™•ì¸
   - â° **2ë¶„ í›„**: ìƒì„¸ ë¶„ì„ ì´ë©”ì¼ ìˆ˜ì‹  í™•ì¸

### 6.2 íŠ¸ë¦¬ê±° í™•ì¸
1. Apps Script ì—ë””í„° **íŠ¸ë¦¬ê±°** ë©”ë‰´ (ì™¼ìª½ ì‹œê³„ ì•„ì´ì½˜) í´ë¦­
2. ìƒì„±ëœ íŠ¸ë¦¬ê±° 6ê°œ í™•ì¸:
   - `sendDelayedDetailedReport` (2ë¶„ í›„)
   - `sendWeek1Email` (3ë¶„ í›„)
   - `sendWeek2Email` (4ë¶„ í›„)
   - `sendWeek3Email` (5ë¶„ í›„)
   - `sendWeek4Email` (6ë¶„ í›„)
   - `sendCompletionEmail` (7ë¶„ í›„)

### 6.3 ë¡œê·¸ í™•ì¸
1. Apps Script ì—ë””í„° **ì‹¤í–‰** ë©”ë‰´ (ì™¼ìª½ ì‹¤í–‰ ì•„ì´ì½˜) í´ë¦­
2. ê° í•¨ìˆ˜ ì‹¤í–‰ ë¡œê·¸ í™•ì¸
3. ì˜¤ë¥˜ ë°œìƒ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### âŒ ì´ë©”ì¼ì´ ì „ì†¡ë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: MailApp ê¶Œí•œ ë¶€ì—¬ ì•ˆë¨
- **í•´ê²°**: Apps Script ì—ë””í„°ì—ì„œ `sendWelcomeEmail` í•¨ìˆ˜ ì‹¤í–‰ > ê¶Œí•œ ë¶€ì—¬

### âŒ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì— ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: SPREADSHEET_ID ë¯¸ì„¤ì • ë˜ëŠ” ì˜ëª»ë¨
- **í•´ê²°**: 
  1. í”„ë¡œì íŠ¸ ì„¤ì • > ìŠ¤í¬ë¦½íŠ¸ ì†ì„± í™•ì¸
  2. ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URLì—ì„œ ID ì¬í™•ì¸
  3. ê¶Œí•œ í™•ì¸ (ìŠ¤í”„ë ˆë“œì‹œíŠ¸ í¸ì§‘ ê¶Œí•œ)

### âŒ íŠ¸ë¦¬ê±°ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: íŠ¸ë¦¬ê±° ìƒì„± ì‹¤íŒ¨ ë˜ëŠ” ê¶Œí•œ ë¶€ì¡±
- **í•´ê²°**:
  1. íŠ¸ë¦¬ê±° ë©”ë‰´ì—ì„œ ìˆ˜ë™ íŠ¸ë¦¬ê±° ì‚­ì œ
  2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•˜ì—¬ íŠ¸ë¦¬ê±° ì¬ìƒì„±
  3. Apps Script ì‹¤í–‰ ë¡œê·¸ í™•ì¸

### âŒ "Script function not found" ì˜¤ë¥˜
- **ì›ì¸**: í•¨ìˆ˜ëª… ì˜¤íƒ€ ë˜ëŠ” ì½”ë“œ ì €ì¥ ì•ˆë¨
- **í•´ê²°**:
  1. ì½”ë“œ ì €ì¥ í™•ì¸ (Ctrl+S)
  2. í•¨ìˆ˜ëª… ì² ì í™•ì¸
  3. ë°°í¬ ì—…ë°ì´íŠ¸ (ìƒˆ ë°°í¬ ë˜ëŠ” ë°°í¬ ê´€ë¦¬ > ìˆ˜ì •)

---

## ğŸ¨ ì‹¤ì œ ìš´ì˜ ì‹œ ë³€ê²½ì‚¬í•­

í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ë©´ ë‹¤ìŒì„ ì‹¤ì œ ì‹œê°„ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”:

### doPost í•¨ìˆ˜ ë‚´ íŠ¸ë¦¬ê±° ì‹œê°„ ìˆ˜ì •:

```javascript
// í˜„ì¬ (í…ŒìŠ¤íŠ¸ìš©)
.after(2 * 60 * 1000)  // 2ë¶„ í›„ â†’ 24ì‹œê°„ í›„ë¡œ ë³€ê²½
.after(3 * 60 * 1000)  // 3ë¶„ í›„ â†’ ì¦‰ì‹œë¡œ ë³€ê²½
.after(4 * 60 * 1000)  // 4ë¶„ í›„ â†’ 7ì¼ë¡œ ë³€ê²½
.after(5 * 60 * 1000)  // 5ë¶„ í›„ â†’ 14ì¼ë¡œ ë³€ê²½
.after(6 * 60 * 1000)  // 6ë¶„ í›„ â†’ 21ì¼ë¡œ ë³€ê²½
.after(7 * 60 * 1000)  // 7ë¶„ í›„ â†’ 28ì¼ë¡œ ë³€ê²½

// ì‹¤ì œ ìš´ì˜ (ê¶Œì¥)
.after(24 * 60 * 60 * 1000)       // 24ì‹œê°„ í›„
.after(1 * 60 * 1000)              // 1ë¶„ í›„ (ì¦‰ì‹œ)
.after(7 * 24 * 60 * 60 * 1000)   // 7ì¼ í›„
.after(14 * 24 * 60 * 60 * 1000)  // 14ì¼ í›„
.after(21 * 24 * 60 * 60 * 1000)  // 21ì¼ í›„
.after(28 * 24 * 60 * 60 * 1000)  // 28ì¼ í›„
```

---

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### Google Sheets í—¤ë”
```
Timestamp | Email | Total Score | Core | Compassion | Stability | Growth | Social | Profile Type | Answers | Variance | Reliability
```

### Script Properties ì €ì¥ ë°ì´í„°
```
í‚¤: user_{email_replaced}
ê°’: {
  email, userName, totalScore, coreScore, 
  compassionScore, stabilityScore, growthScore, 
  socialScore, profileType, answers, strengths, timestamp
}
```

---

## ğŸ”’ ë³´ì•ˆ ê¶Œì¥ì‚¬í•­

1. **ì›¹ ì•± URL ë¹„ê³µê°œ ìœ ì§€**: URLì„ ì•Œë©´ ëˆ„êµ¬ë‚˜ ë°ì´í„° ì „ì†¡ ê°€ëŠ¥
2. **ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ê¶Œí•œ ì œí•œ**: ë³¸ì¸ë§Œ í¸ì§‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
3. **ì£¼ê¸°ì  ë¡œê·¸ í™•ì¸**: ë¹„ì •ìƒ í™œë™ ëª¨ë‹ˆí„°ë§
4. **ë¯¼ê° ì •ë³´ ë³´í˜¸**: ì´ë©”ì¼ ì£¼ì†Œ ë“± ê°œì¸ì •ë³´ ê´€ë¦¬

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Google Apps Script ê³µì‹ ë¬¸ì„œ](https://developers.google.com/apps-script)
- [MailApp í´ë˜ìŠ¤](https://developers.google.com/apps-script/reference/mail/mail-app)
- [SpreadsheetApp í´ë˜ìŠ¤](https://developers.google.com/apps-script/reference/spreadsheet)
- [íŠ¸ë¦¬ê±° ì„œë¹„ìŠ¤](https://developers.google.com/apps-script/guides/triggers)

---

## ğŸ’¡ ì¶”ê°€ ê¸°ëŠ¥ ì œì•ˆ

### PDF ì²¨ë¶€ ê¸°ëŠ¥ (í–¥í›„ ê°œì„ )
```javascript
// PDF ìƒì„± ë° ì²¨ë¶€ (Google Docs API í™œìš©)
var pdfBlob = generatePdfReport(triggerData);
MailApp.sendEmail({
  to: triggerData.email,
  subject: "ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ",
  htmlBody: emailBody,
  attachments: [pdfBlob]
});
```

### ë°ì´í„° ë°±ì—… ìë™í™”
```javascript
// ë§¤ì£¼ ì¼ìš”ì¼ ìë™ ë°±ì—…
function weeklyBackup() {
  var sheet = SpreadsheetApp.openById(SPREADSHEET_ID);
  var backupFolder = DriveApp.getFolderById(BACKUP_FOLDER_ID);
  sheet.makeCopy("Backup_" + new Date().toISOString(), backupFolder);
}
```

---

## âœ‰ï¸ ë¬¸ì˜

ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ë‹¤ìŒ ì •ë³´ì™€ í•¨ê»˜ ë¬¸ì˜í•´ì£¼ì„¸ìš”:
- Google Apps Script ì‹¤í–‰ ë¡œê·¸
- ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL (ê¶Œí•œ ê³µìœ )
- ì›¹ ì•± URL
- ë°œìƒí•œ ì˜¤ë¥˜ ë©”ì‹œì§€

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024-02-08
**ë²„ì „**: 1.0
